<!DOCTYPE html>

<html lang="en">

<head>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <meta charset="UTF-8">
    <title>PANEL</title>
    <link rel="stylesheet" href="./style/style.css">
    <script>
        /*Данный скрипт грузит скорость из speed.txt*/
        function loadXMLDoc() {
            var xmlhttp;
            if (window.XMLHttpRequest) { // код для IE7+, Firefox, Chrome, Opera, Safari
                xmlhttp = new XMLHttpRequest();
            } else { // код для IE6, IE5 (мало ли
                xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
            }
            xmlhttp.onreadystatechange = function() {
                if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                    document.getElementById("myDiv").innerHTML = xmlhttp.responseText; // вот это отправляется в Div myDiv
                }
            }

            //
            xmlhttp.open("GET", "./bin/vars/speed.txt", true);
            xmlhttp.setRequestHeader('Cache-Control', 'no-cache');
            xmlhttp.send();

            var xmlhttp2;
            if (window.XMLHttpRequest) { // код для IE7+, Firefox, Chrome, Opera, Safari
                xmlhttp2 = new XMLHttpRequest();
            } else { // код для IE6, IE5 (мало ли
                xmlhttp2 = new ActiveXObject("Microsoft.XMLHTTP");
            }
            xmlhttp2.onreadystatechange = function() {
                if (xmlhttp2.readyState == 4 && xmlhttp2.status == 200) {
                    document.getElementById("myDiv2").innerHTML = xmlhttp2.responseText; // вот это отправляется в Div myDiv

                }
            }

            //
            xmlhttp2.open("GET", "./bin/vars/gear.txt", true);
            xmlhttp2.setRequestHeader('Cache-Control', 'no-cache');
            xmlhttp2.send();

            var xmlhttp3;
            if (window.XMLHttpRequest) { // код для IE7+, Firefox, Chrome, Opera, Safari
                xmlhttp3 = new XMLHttpRequest();
            } else { // код для IE6, IE5 (мало ли
                xmlhttp3 = new ActiveXObject("Microsoft.XMLHTTP");
            }
            xmlhttp3.onreadystatechange = function() {
                if (xmlhttp3.readyState == 4 && xmlhttp2.status == 200) {
                    document.getElementById("myDiv3").innerHTML = xmlhttp3.responseText; // вот это отправляется в Div myDiv

                }
            }


            //
            xmlhttp3.open("GET", "./bin/vars/tax.txt", true);
            xmlhttp3.setRequestHeader('Cache-Control', 'no-cache');
            xmlhttp3.send();

            var xmlhttp4;
            if (window.XMLHttpRequest) { // код для IE7+, Firefox, Chrome, Opera, Safari
                xmlhttp4 = new XMLHttpRequest();
            } else { // код для IE6, IE5 (мало ли
                xmlhttp4 = new ActiveXObject("Microsoft.XMLHTTP");
            }
            xmlhttp4.onreadystatechange = function() {
                if (xmlhttp3.readyState == 4 && xmlhttp2.status == 200) {
                    document.getElementById("myDiv4").innerHTML = xmlhttp4.responseText; // вот это отправляется в Div myDiv

                }
            }

            //
            xmlhttp4.open("GET", "./bin/vars/max.txt", true);
            xmlhttp4.setRequestHeader('Cache-Control', 'no-cache');
            xmlhttp4.send();
        }

        /* Данный цикл являеся бесконечным, почти. Надо порешать всё таки как это сделать  */
        //  говнокод


        function myLoop() {
            setTimeout(function() {
                    loadXMLDoc();
                    //console.log();           
                    var speed = document.getElementById('myDiv').innerHTML;
                    var spedoraz = speed.substring(0, 3);
                    //                
                    var gear = document.getElementById('myDiv2').innerHTML;
                    var geroraz = gear.substring(0, 1);
                    //           
                    var tax = document.getElementById('myDiv3').innerHTML;
                    var taxoraz = tax.substring(0, 4);
                    //               
                    var max = document.getElementById('myDiv4').innerHTML;
                    var maxoraz = max.substring(0, 3);
                    //              
                    //console.log(spedoraz,geroraz,taxoraz,maxoraz);




                    drawSpeedo(spedoraz, geroraz, taxoraz, maxoraz); //  говнокод рисует спидометр
                    if (20 > 1) {
                        myLoop();
                    //    play();
                    }
                }, 50) //  говнокод задержка 50мс
        }

        myLoop(); //  говнокод запускает цикл
    </script>

</head>

<body>
    <canvas id="canvas"></canvas>
    <div id="myDiv">Скорость </div>
   <!--<button type="button" onclick="loadXMLDoc()">Изменить скорость</button>-->
    <div id="myDiv2">Передача </div>
   <!-- <button type="button" onclick="loadXMLDoc()">Изменить передачу</button>-->
    <div id="myDiv3">Оборотов</div>
   <!-- <button type="button" onclick="loadXMLDoc()">Изменить тахометр</button>-->
    <div id="myDiv4">Максималька </div>
   <!-- <button type="button" onclick="loadXMLDoc()">Изменить макс.скорость</button>-->
</body>

</html>

<!-- partial -->
<script src="./js/script.js"></script>
<script src="./js/jquery-3.5.1.min.js"></script>